package in.yh.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import in.yh.pojo.User;
import in.yh.utility.DBConnection;

public class UserDao {
	Connection conn=DBConnection.getConnect();
	ResultSet  rs=null;
	String sql;
	PreparedStatement ps=null;
	int i=0;
	User u;
	
	
	public boolean RegisterUser(User u) {
		System.out.println("Inside Register User");
		try {
		
		sql="insert into user(name,email,password)values(?,?,?)";
		ps=conn.prepareStatement(sql);
		ps.setString(1,u.getName());
		ps.setString(2, u.getEmail());
		ps.setString(3, u.getPassword());
		
		System.out.println("Query"+ps);
		i=ps.executeUpdate();
		
		if(i>0)
			return true;
		}
		catch(SQLException e) {
			e.printStackTrace();
		}
		return false;
	}
	
	public User getUser(String email) {
		
		sql="select * from user where email=?";
		try {
			ps=conn.prepareStatement(sql);
			ps.setString(1, email);
			rs= ps.executeQuery();
			while(rs.next()) {
				int id=rs.getInt(1);
				String name=rs.getString(2);
				String password=rs.getString(4);
				u=new User(id, name, email, password);
				
			}
			
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return u;
		
		
		
	}
	
	
}
