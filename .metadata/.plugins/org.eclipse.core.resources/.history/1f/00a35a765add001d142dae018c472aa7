package in.yh.controllers;

import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import in.yh.dao.UserDao;
import in.yh.pojo.User;


@WebServlet("/RegisterUser")
public class RegisterUser extends HttpServlet {
	PrintWriter out=null;
	
	String action=null;
	boolean result;
	
	HttpSession session=null;
	RequestDispatcher rd= null;
	
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		// TODO Auto-generated method stub
		response.getWriter().append("Served at: ").append(request.getContextPath());
	}

	/**
	 * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
	
		String name=request.getParameter("name");
		String utype=request.getParameter("utype");
		String email=request.getParameter("email");
		String password=request.getParameter("password");
		User u=new User(name, email, utype ,password);
		session=request.getSession();
		UserDao udao=new UserDao();
		if(utype.equals("doctor")) {
			result= udao.RegisterDoctor(u);
		}
		else if(utype.equals("admin")) {
			result=udao.RegisterAdmin(u);
		}
		else {
			result=udao.RegisterUser(u);
		}
		
		 if(result) {
			 session.setAttribute("msg", "Registered sucessfully");
			 System.out.println("registered");
			 response.sendRedirect("/YouHeal/jsp/register.jsp");
			 
		 }
		 else
			{
				session.setAttribute("errmsg", "product not added sucessfully");
				System.out.println("not registered");
				response.sendRedirect("/YouHeal/jsp/register.jsp");
			}
		 
		}
	

}
